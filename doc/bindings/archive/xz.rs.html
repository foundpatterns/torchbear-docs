<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Module List</title>
    <link rel="stylesheet" type="text/css" href="../../../css/lua.css">
</head>
<body>
	<pre><code id="1">use rlua::prelude::*;</code><code id="2">use std::fs;</code><code id="3">use std::io::Read;</code><code id="4">use xz2::read::*;</code><code id="5">use super::ByteBuf;</code><code id="6"></code><code id="7">pub fn init(lua: &amp;Lua) -&gt; ::Result&lt;()&gt; {</code><code id="8">    let module = lua.create_table()?;</code><code id="9">    module.set(&quot;decompress&quot;, lua.create_function(|_, file: (String)| {</code><code id="10">        let file = fs::File::open(&amp;file).map_err(LuaError::external)?;</code><code id="11">        let mut data = XzDecoder::new(file);</code><code id="12">        let mut buf = vec![];</code><code id="13">        data.read_to_end(&amp;mut buf).map_err(LuaError::external)?;</code><code id="14">        Ok(ByteBuf(buf))</code><code id="15">    })?)?;</code><code id="16"></code><code id="17">    lua.globals().set(&quot;xz&quot;, module)?;</code><code id="18"></code><code id="19">    Ok(())</code><code id="20">}</code><code id="21"></code></pre>
</body>
</html>
